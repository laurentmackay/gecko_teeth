
##########################
##########             N=5
##########################



#MED VALUES OF DIFFUSION COEFFICIENT
k2=1
rp_anti_eps=run('FHN_secrete',dat='five_6_anti',  PAR={'kappa2':k2, 'eps':1}, LAB=31,SP=['LP6', 'BP2'], IBR=1, NPR=100, NMX=1200)

rp_anti_PHASE=run('FHN_secrete',dat='five_6_anti',  PAR={'kappa2':k2, 'eps':1}, UZSTOP={'sense_phase':[8]}, NPR=1, NMX=20, ICP=['sense_phase', 11, 14, 13, 15, 16, 17], UZR={'sense_phase':[6,7,8]}, DS=.5, DSMAX=1)
rp_anti_PHASE2=run('FHN_secrete',dat='five_6_anti',  PAR={'kappa2':k2, 'eps':1}, UZSTOP={'sense_phase':[1]}, NPR=1, NMX=100, ICP=['sense_phase', 11, 14, 13, 15, 16, 17], UZR={'sense_phase':[1,2,3,4,5]}, DS=-.5, DSMAX=1)


sv('anti5_2_eps_for')
rp_anti_eps2=run('FHN_secrete',dat='five_6_anti',  PAR={'mu':1, 'kappa2':k2, 'f':0.8}, LAB=61, SP=['LP6', 'BP2'], IBR=1, NPR=100, NMX=1500, DS='-')
sv('anti5_2_eps_back')



#Uss = {1 : -1.759462493E-01, 2 : -1.759462493E-01, 3 : -1.759462493E-01, 4 : -1.759462493E-01, 5 : -1.759462493E-01, 6 : -9.843997752E-01, 7 : -9.843997752E-01, 8 : -9.843997752E-01, 9 : -9.843997752E-01, 10 : -9.843997752E-01, 11 : 6.116650398E+01, 12 : 6.117606124E+01, 13 : 6.119517727E+01, 14 : 6.122385504E+01, 15 : 6.126209904E+01, 16 : 6.130991524E+01, 17 : 6.136731112E+01, 18 : 6.143429564E+01, 19 : 6.151087927E+01, 20 : 6.159707397E+01, 21 : 6.169289322E+01, 22 : 6.179835198E+01, 23 : 6.191346673E+01, 24 : 6.203825546E+01, 25 : 6.217273767E+01, 26 : 6.231693437E+01, 27 : 6.247086809E+01, 28 : 6.263456288E+01, 29 : 6.280804433E+01, 30 : 6.299133953E+01, 31 : 6.299133953E+01, 32 : 6.280804433E+01, 33 : 6.263456288E+01, 34 : 6.247086809E+01, 35 : 6.231693437E+01, 36 : 6.217273767E+01, 37 : 6.203825546E+01, 38 : 6.191346673E+01, 39 : 6.179835198E+01, 40 : 6.169289322E+01, 41 : 6.159707397E+01, 42 : 6.151087927E+01, 43 : 6.143429564E+01, 44 : 6.136731112E+01, 45 : 6.130991524E+01, 46 : 6.126209904E+01, 47 : 6.122385504E+01, 48 : 6.119517727E+01, 49 : 6.117606124E+01, 50 : 6.116650398E+01, 51 : 6.116650398E+01, 52 : 6.117606124E+01, 53 : 6.119517727E+01, 54 : 6.122385504E+01, 55 : 6.126209904E+01, 56 : 6.130991524E+01, 57 : 6.136731112E+01, 58 : 6.143429564E+01, 59 : 6.151087927E+01, 60 : 6.159707397E+01, 61 : 6.169289322E+01, 62 : 6.179835198E+01, 63 : 6.191346673E+01, 64 : 6.203825546E+01, 65 : 6.217273767E+01, 66 : 6.231693437E+01, 67 : 6.247086809E+01, 68 : 6.263456288E+01, 69 : 6.280804433E+01, 70 : 6.299133953E+01, 71 : 6.299133953E+01, 72 : 6.280804433E+01, 73 : 6.263456288E+01, 74 : 6.247086809E+01, 75 : 6.231693437E+01, 76 : 6.217273767E+01, 77 : 6.203825546E+01, 78 : 6.191346673E+01, 79 : 6.179835198E+01, 80 : 6.169289322E+01, 81 : 6.159707397E+01, 82 : 6.151087927E+01, 83 : 6.143429564E+01, 84 : 6.136731112E+01, 85 : 6.130991524E+01, 86 : 6.126209904E+01, 87 : 6.122385504E+01, 88 : 6.119517727E+01, 89 : 6.117606124E+01, 90 : 6.116650398E+01, 91 : 6.116650398E+01, 92 : 6.117606124E+01, 93 : 6.119517727E+01, 94 : 6.122385504E+01, 95 : 6.126209904E+01, 96 : 6.130991524E+01, 97 : 6.136731112E+01, 98 : 6.143429564E+01, 99 : 6.151087927E+01, 100 : 6.159707397E+01, 101 : 6.169289322E+01, 102 : 6.179835198E+01, 103 : 6.191346673E+01, 104 : 6.203825546E+01, 105 : 6.217273767E+01, 106 : 6.231693437E+01, 107 : 6.247086809E+01, 108 : 6.263456288E+01, 109 : 6.280804433E+01, 110 : 6.299133953E+01, 111 : 6.299133953E+01, 112 : 6.280804433E+01, 113 : 6.263456288E+01, 114 : 6.247086809E+01, 115 : 6.231693437E+01, 116 : 6.217273767E+01, 117 : 6.203825546E+01, 118 : 6.191346673E+01, 119 : 6.179835198E+01, 120 : 6.169289322E+01, 121 : 6.159707397E+01, 122 : 6.151087927E+01, 123 : 6.143429564E+01, 124 : 6.136731112E+01, 125 : 6.130991524E+01, 126 : 6.126209904E+01, 127 : 6.122385504E+01, 128 : 6.119517727E+01, 129 : 6.117606124E+01, 130 : 6.116650398E+01, 131 : 6.116650398E+01, 132 : 6.117606124E+01, 133 : 6.119517727E+01, 134 : 6.122385504E+01, 135 : 6.126209904E+01, 136 : 6.130991524E+01, 137 : 6.136731112E+01, 138 : 6.143429564E+01, 139 : 6.151087927E+01, 140 : 6.159707397E+01, 141 : 6.169289322E+01, 142 : 6.179835198E+01, 143 : 6.191346673E+01, 144 : 6.203825546E+01, 145 : 6.217273767E+01, 146 : 6.231693437E+01, 147 : 6.247086809E+01, 148 : 6.263456288E+01, 149 : 6.280804433E+01, 150 : 6.299133953E+01, 151 : 6.299133953E+01, 152 : 6.280804433E+01, 153 : 6.263456288E+01, 154 : 6.247086809E+01, 155 : 6.231693437E+01, 156 : 6.217273767E+01, 157 : 6.203825546E+01, 158 : 6.191346673E+01, 159 : 6.179835198E+01, 160 : 6.169289322E+01, 161 : 6.159707397E+01, 162 : 6.151087927E+01, 163 : 6.143429564E+01, 164 : 6.136731112E+01, 165 : 6.130991524E+01, 166 : 6.126209904E+01, 167 : 6.122385504E+01, 168 : 6.119517727E+01, 169 : 6.117606124E+01, 170 : 6.116650398E+01, 171 : 6.116650398E+01, 172 : 6.117606124E+01, 173 : 6.119517727E+01, 174 : 6.122385504E+01, 175 : 6.126209904E+01, 176 : 6.130991524E+01, 177 : 6.136731112E+01, 178 : 6.143429564E+01, 179 : 6.151087927E+01, 180 : 6.159707397E+01, 181 : 6.169289322E+01, 182 : 6.179835198E+01, 183 : 6.191346673E+01, 184 : 6.203825546E+01, 185 : 6.217273767E+01, 186 : 6.231693437E+01, 187 : 6.247086809E+01, 188 : 6.263456288E+01, 189 : 6.280804433E+01, 190 : 6.299133953E+01, 191 : 6.299133953E+01, 192 : 6.280804433E+01, 193 : 6.263456288E+01, 194 : 6.247086809E+01, 195 : 6.231693437E+01, 196 : 6.217273767E+01, 197 : 6.203825546E+01, 198 : 6.191346673E+01, 199 : 6.179835198E+01, 200 : 6.169289322E+01, 201 : 6.159707397E+01, 202 : 6.151087927E+01, 203 : 6.143429564E+01, 204 : 6.136731112E+01, 205 : 6.130991524E+01, 206 : 6.126209904E+01, 207 : 6.122385504E+01, 208 : 6.119517727E+01, 209 : 6.117606124E+01, 210 : 6.116650398E+01, }

#need to drop this down to NDIM=110, otherwise we can't ever pass through that first BP
#r_sym_eps = run('FHN_secrete', PAR={'mu':1, 'kappa':2, 'f':1.2}, LAB=200, SP=['LP6'], IBR=1, NPR=1000, NMX=5000, DS=-0.001, U=Uss, IPS=1, UZSTOP={2:[1.5]}, MXBF=25)
#r_sym_eps2 = run('FHN_secrete', PAR={'mu':1, 'kappa':2, 'f':1.2}, LAB=200, SP=['LP6'], IBR=1,  NPR=1000, NMX=5000, DS=0.01, U=Uss, IPS=1, UZSTOP={2:[1.5]})

#pl(rp_sync_eps+rp_sync_eps2+rp_anti_eps+rp_anti_eps2 + r_sym_eps+ r_sym_eps2, stability=True, use_labels=False)

anti_TR10=run('FHN_secrete',dat='five_anti',  PAR={'mu':1, 'kappa2':k2, 'f':0.8}, LAB=31,SP=['LP6', 'BP2'], DS='-', UZSTOP={'f':0.64}, NPR=1, NTST=50)
anti_TR1=run(anti_TR10, SP=['TR2'],  DSMAX=0.1, DS=-0.01)


tr1_2par0 = run(anti_TR1('TR1'), ISW=2, IPS=2, ISP=2, ICP=[2, 5, 11, 12, 15], NTST=50,   DSMAX=0.1, NPR=1, NMX=150)
sv('anti_tr1_bndry_2par0')
tr1_2par = run(tr1_2par0, NPR=20, DS=0.01, DSMAX=1, NMX=400, SP=['R21'], UZSTOP = {2: [0], 11:[30,700], 5:[0,9]})
sv('anti_tr1_bndry_2par')

anti_pd1=run('FHN_secrete',dat='five_anti',  PAR={'mu':1, 'kappa2':4, 'f':0.8}, LAB=31,SP=['PD1'], IBR=1, NPR=100, NMX=1200)


pd1_2par0 = run(anti_pd1('PD1'), ISW=2, IPS=2, ISP=2, ICP=[2, 5, 11, 15], DSMAX=0.1, NTST=75, NPR=1, NMX=500)
sv('anti_pd1_bndry_2par0')
pd1_2par = run(pd1_2par0, NPR=10, DS='-', NMX=800)
sv('anti_pd1_bndry_2par')



bp1_2par= run(r_sym_eps('BP1'), ISW=2, IPS=1, ISP=2, ICP=[2, 5, 11, 15],  DSMAX=10, DS=-1, NPR=50, NMX=250)


sv('anti_bp_bndry_2par0')

trp1_2par = run(pd1_2par0, NPR=10, DSMAX=100, DS=10, NMX=200)


#LOW VALUES OF DIFFUSION COEFFICIENT


rp_sync_lo_eps=run('FHN_secrete',dat='five_sync_lo',  PAR={'mu':1, 'kappa':1, 'f':0.6}, LAB=1,SP=['LP2'], IBR=1, NPR=100)
sv('sync5_1_eps_for')
rp_sync_lo_eps2=run('FHN_secrete',dat='five_sync_lo', PAR={'mu':1,'kappa':1, 'f':0.6}, NMX=80, LAB=15,SP=['LP6','BP1'], IBR=1, NPR=20, DS='-')
sv('sync5_1_eps_back')




Uss_lo = {1 : 3.890147927E-02, 2 : 3.890147927E-02, 3 : 3.890147927E-02, 4 : 3.890147927E-02, 5 : 3.890147927E-02, 6 : -9.992430510E-01, 7 : -9.992430510E-01, 8 : -9.992430510E-01, 9 : -9.992430510E-01, 10 : -9.992430510E-01, 11 : 7.479508883E+01, 12 : 7.498207655E+01, 13 : 7.535651947E+01, 14 : 7.591935368E+01, 15 : 7.667198628E+01, 16 : 7.761629884E+01, 17 : 7.875465215E+01, 18 : 8.008989209E+01, 19 : 8.162535676E+01, 20 : 8.336488482E+01, 21 : 8.336488482E+01, 22 : 8.162535676E+01, 23 : 8.008989209E+01, 24 : 7.875465215E+01, 25 : 7.761629884E+01, 26 : 7.667198628E+01, 27 : 7.591935368E+01, 28 : 7.535651947E+01, 29 : 7.498207655E+01, 30 : 7.479508883E+01, 31 : 7.479508883E+01, 32 : 7.498207655E+01, 33 : 7.535651947E+01, 34 : 7.591935368E+01, 35 : 7.667198628E+01, 36 : 7.761629884E+01, 37 : 7.875465215E+01, 38 : 8.008989209E+01, 39 : 8.162535676E+01, 40 : 8.336488482E+01, 41 : 8.336488482E+01, 42 : 8.162535676E+01, 43 : 8.008989209E+01, 44 : 7.875465215E+01, 45 : 7.761629884E+01, 46 : 7.667198628E+01, 47 : 7.591935368E+01, 48 : 7.535651947E+01, 49 : 7.498207655E+01, 50 : 7.479508883E+01, 51 : 7.479508883E+01, 52 : 7.498207655E+01, 53 : 7.535651947E+01, 54 : 7.591935368E+01, 55 : 7.667198628E+01, 56 : 7.761629884E+01, 57 : 7.875465215E+01, 58 : 8.008989209E+01, 59 : 8.162535676E+01, 60 : 8.336488482E+01, 61 : 8.336488482E+01, 62 : 8.162535676E+01, 63 : 8.008989209E+01, 64 : 7.875465215E+01, 65 : 7.761629884E+01, 66 : 7.667198628E+01, 67 : 7.591935368E+01, 68 : 7.535651947E+01, 69 : 7.498207655E+01, 70 : 7.479508883E+01, 71 : 7.479508883E+01, 72 : 7.498207655E+01, 73 : 7.535651947E+01, 74 : 7.591935368E+01, 75 : 7.667198628E+01, 76 : 7.761629884E+01, 77 : 7.875465215E+01, 78 : 8.008989209E+01, 79 : 8.162535676E+01, 80 : 8.336488482E+01, 81 : 8.336488482E+01, 82 : 8.162535676E+01, 83 : 8.008989209E+01, 84 : 7.875465215E+01, 85 : 7.761629884E+01, 86 : 7.667198628E+01, 87 : 7.591935368E+01, 88 : 7.535651947E+01, 89 : 7.498207655E+01, 90 : 7.479508883E+01, 91 : 7.479508883E+01, 92 : 7.498207655E+01, 93 : 7.535651947E+01, 94 : 7.591935368E+01, 95 : 7.667198628E+01, 96 : 7.761629884E+01, 97 : 7.875465215E+01, 98 : 8.008989209E+01, 99 : 8.162535676E+01, 100 : 8.336488482E+01, 101 : 8.336488482E+01, 102 : 8.162535676E+01, 103 : 8.008989209E+01, 104 : 7.875465215E+01, 105 : 7.761629884E+01, 106 : 7.667198628E+01, 107 : 7.591935368E+01, 108 : 7.535651947E+01, 109 : 7.498207655E+01, 110 : 7.479508883E+01, }


#need to drop this down to NDIM=110, otherwise we can't ever pass through that first BP
r_sym_lo_eps = run('FHN_secrete', NDIM=110, PAR={'mu':1, 'kappa':1, 'f':.9}, LAB=200, SP=['LP6'], IBR=1, NPR=1000, NMX=5000, DS=-0.001, U=Uss_lo, IPS=1, UZSTOP={2:[1.5]}, MXBF=25)




bp1_2par= run(r_sym_lo_eps('BP1'), ISW=2, IPS=1, ISP=2, ICP=[2,5,11], NTST=150, DSMAX=10, DS=-1, NPR=50, NMX=250)

